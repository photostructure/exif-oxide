//! Generated tag table definitions from Pentax::CameraInfo
//!
//! This file is auto-generated by codegen/src/strategies/tag_kit.rs. Do not edit manually.

use crate::types::{PrintConv, TagInfo, ValueConv};
use std::collections::HashMap;
use std::sync::LazyLock;

// Generated imports for conversion functions
use crate::generated::functions::hash_8d::ast_value_8d0fef0c52482fb5;
use crate::generated::functions::hash_a2::ast_value_a24e3c619aa3ac61;
use crate::generated::functions::hash_ba::ast_print_ba0399c7192e8c6c;

/// Tag definitions for Pentax::CameraInfo table
pub static PENTAX_CAMERAINFO_TAGS: LazyLock<HashMap<u16, TagInfo>> = LazyLock::new(|| {
    HashMap::from([
        (
            0,
            TagInfo {
                name: "PentaxModelID",
                format: "unknown",
                print_conv: Some(PrintConv::Simple(std::collections::HashMap::from([
                    ("13".to_string(), "Optio 330/430"),
                    ("76070".to_string(), "Optio 230"),
                    ("76120".to_string(), "Optio 330GS"),
                    ("76130".to_string(), "Optio 450/550"),
                    ("76140".to_string(), "Optio S"),
                    ("76145".to_string(), "Optio S V1.01"),
                    ("76180".to_string(), "*ist D"),
                    ("76210".to_string(), "Optio 33L"),
                    ("76220".to_string(), "Optio 33LF"),
                    ("76230".to_string(), "Optio 33WR/43WR/555"),
                    ("76245".to_string(), "Optio S4"),
                    ("76290".to_string(), "Optio MX"),
                    ("76300".to_string(), "Optio S40"),
                    ("76310".to_string(), "Optio S4i"),
                    ("76340".to_string(), "Optio 30"),
                    ("76370".to_string(), "Optio S30"),
                    ("76390".to_string(), "Optio 750Z"),
                    ("76400".to_string(), "Optio SV"),
                    ("76405".to_string(), "Optio SVi"),
                    ("76410".to_string(), "Optio X"),
                    ("76430".to_string(), "Optio S5i"),
                    ("76440".to_string(), "Optio S50"),
                    ("76450".to_string(), "*ist DS"),
                    ("76470".to_string(), "Optio MX4"),
                    ("76480".to_string(), "Optio S5n"),
                    ("76490".to_string(), "Optio WP"),
                    ("76540".to_string(), "Optio S55"),
                    ("76560".to_string(), "Optio S5z"),
                    ("76570".to_string(), "*ist DL"),
                    ("76580".to_string(), "Optio S60"),
                    ("76590".to_string(), "Optio S45"),
                    ("76600".to_string(), "Optio S6"),
                    ("76620".to_string(), "Optio WPi"),
                    ("76630".to_string(), "BenQ DC X600"),
                    ("76640".to_string(), "*ist DS2"),
                    ("76642".to_string(), "Samsung GX-1S"),
                    ("76650".to_string(), "Optio A10"),
                    ("76670".to_string(), "*ist DL2"),
                    ("76672".to_string(), "Samsung GX-1L"),
                    ("76700".to_string(), "K100D"),
                    ("76701".to_string(), "K110D"),
                    ("76706".to_string(), "K100D Super"),
                    ("76720".to_string(), "Optio T10/T20"),
                    ("76770".to_string(), "Optio W10"),
                    ("76790".to_string(), "Optio M10"),
                    ("76830".to_string(), "K10D"),
                    ("76832".to_string(), "Samsung GX10"),
                    ("76840".to_string(), "Optio S7"),
                    ("76845".to_string(), "Optio L20"),
                    ("76850".to_string(), "Optio M20"),
                    ("76860".to_string(), "Optio W20"),
                    ("76870".to_string(), "Optio A20"),
                    ("76920".to_string(), "Optio E30"),
                    ("76925".to_string(), "Optio E35"),
                    ("76930".to_string(), "Optio T30"),
                    ("76940".to_string(), "Optio M30"),
                    ("76945".to_string(), "Optio L30"),
                    ("76950".to_string(), "Optio W30"),
                    ("76960".to_string(), "Optio A30"),
                    ("76980".to_string(), "Optio E40"),
                    ("76990".to_string(), "Optio M40"),
                    ("76995".to_string(), "Optio L40"),
                    ("76997".to_string(), "Optio L36"),
                    ("77000".to_string(), "Optio Z10"),
                    ("77010".to_string(), "K20D"),
                    ("77012".to_string(), "Samsung GX20"),
                    ("77020".to_string(), "Optio S10"),
                    ("77030".to_string(), "Optio A40"),
                    ("77040".to_string(), "Optio V10"),
                    ("77050".to_string(), "K200D"),
                    ("77060".to_string(), "Optio S12"),
                    ("77070".to_string(), "Optio E50"),
                    ("77080".to_string(), "Optio M50"),
                    ("77090".to_string(), "Optio L50"),
                    ("77100".to_string(), "Optio V20"),
                    ("77120".to_string(), "Optio W60"),
                    ("77130".to_string(), "Optio M60"),
                    ("77160".to_string(), "Optio E60/M90"),
                    ("77170".to_string(), "K2000"),
                    ("77171".to_string(), "K-m"),
                    ("77190".to_string(), "Optio P70"),
                    ("77200".to_string(), "Optio L70"),
                    ("77210".to_string(), "Optio E70"),
                    ("77230".to_string(), "X70"),
                    ("77240".to_string(), "K-7"),
                    ("77260".to_string(), "Optio W80"),
                    ("77290".to_string(), "Optio P80"),
                    ("77300".to_string(), "Optio WS80"),
                    ("77310".to_string(), "K-x"),
                    ("77320".to_string(), "645D"),
                    ("77330".to_string(), "Optio E80"),
                    ("77360".to_string(), "Optio W90"),
                    ("77370".to_string(), "Optio I-10"),
                    ("77380".to_string(), "Optio H90"),
                    ("77390".to_string(), "Optio E90"),
                    ("77400".to_string(), "X90"),
                    ("77420".to_string(), "K-r"),
                    ("77430".to_string(), "K-5"),
                    ("77450".to_string(), "Optio RS1000/RS1500"),
                    ("77460".to_string(), "Optio RZ10"),
                    ("77470".to_string(), "Optio LS1000"),
                    ("77500".to_string(), "Optio WG-1 GPS"),
                    ("77520".to_string(), "Optio S1"),
                    ("77540".to_string(), "Q"),
                    ("77560".to_string(), "K-01"),
                    ("77580".to_string(), "Optio RZ18"),
                    ("77590".to_string(), "Optio VS20"),
                    ("77610".to_string(), "Optio WG-2 GPS"),
                    ("77640".to_string(), "Optio LS465"),
                    ("77650".to_string(), "K-30"),
                    ("77660".to_string(), "X-5"),
                    ("77670".to_string(), "Q10"),
                    ("77680".to_string(), "K-5 II"),
                    ("77681".to_string(), "K-5 II s"),
                    ("77690".to_string(), "Q7"),
                    ("77700".to_string(), "MX-1"),
                    ("77710".to_string(), "WG-3 GPS"),
                    ("77720".to_string(), "WG-3"),
                    ("77730".to_string(), "WG-10"),
                    ("77750".to_string(), "K-50"),
                    ("77760".to_string(), "K-3"),
                    ("77770".to_string(), "K-500"),
                    ("77790".to_string(), "WG-4 GPS"),
                    ("77800".to_string(), "WG-4"),
                    ("77830".to_string(), "WG-20"),
                    ("77840".to_string(), "645Z"),
                    ("77850".to_string(), "K-S1"),
                    ("77860".to_string(), "K-S2"),
                    ("77870".to_string(), "Q-S1"),
                    ("77910".to_string(), "WG-30"),
                    ("77950".to_string(), "WG-30W"),
                    ("77960".to_string(), "WG-5 GPS"),
                    ("77970".to_string(), "K-1"),
                    ("77980".to_string(), "K-3 II"),
                    ("78320".to_string(), "WG-M2"),
                    ("78350".to_string(), "GR III"),
                    ("78370".to_string(), "K-70"),
                    ("78380".to_string(), "KP"),
                    ("78400".to_string(), "K-1 Mark II"),
                    ("78420".to_string(), "K-3 Mark III"),
                    ("78480".to_string(), "WG-70"),
                    ("78490".to_string(), "GR IIIx"),
                    ("78520".to_string(), "KF"),
                    ("78550".to_string(), "K-3 Mark III Monochrome"),
                    ("78560".to_string(), "GR IV"),
                ]))),
                value_conv: None,
            },
        ),
        (
            1,
            TagInfo {
                name: "ManufactureDate",
                format: "unknown",
                print_conv: None,
                value_conv: Some(ValueConv::Function(ast_value_8d0fef0c52482fb5)),
            },
        ),
        (
            2,
            TagInfo {
                name: "ProductionCode",
                format: "int32u[2]",
                print_conv: Some(PrintConv::Function(ast_print_ba0399c7192e8c6c)),
                value_conv: Some(ValueConv::Function(ast_value_a24e3c619aa3ac61)),
            },
        ),
    ])
});

/// Apply ValueConv transformation for tags in this table
pub fn apply_value_conv(
    tag_id: u32,
    value: &crate::types::TagValue,
    _errors: &mut Vec<String>,
) -> Result<crate::types::TagValue, crate::types::ExifError> {
    let tag_id_u16 = tag_id as u16;
    if let Some(tag_def) = PENTAX_CAMERAINFO_TAGS.get(&tag_id_u16) {
        if let Some(ref value_conv) = tag_def.value_conv {
            match value_conv {
                ValueConv::None => Ok(value.clone()),
                ValueConv::Function(func) => func(value, None),
                ValueConv::Expression(_expr) => {
                    // Runtime expression evaluation removed - all Perl interpretation happens via PPI at build time
                    Err(crate::types::ExifError::NotImplemented("Runtime expression evaluation not supported - should be handled by PPI at build time".to_string()))
                }
                _ => Ok(value.clone()),
            }
        } else {
            Ok(value.clone())
        }
    } else {
        Err(crate::types::ExifError::ParseError(format!(
            "Tag 0x{:04x} not found in table",
            tag_id
        )))
    }
}

/// Apply PrintConv transformation for tags in this table
pub fn apply_print_conv(
    tag_id: u32,
    value: &crate::types::TagValue,
    _errors: &mut Vec<String>,
    _warnings: &mut Vec<String>,
) -> crate::types::TagValue {
    let tag_id_u16 = tag_id as u16;
    if let Some(tag_def) = PENTAX_CAMERAINFO_TAGS.get(&tag_id_u16) {
        if let Some(ref print_conv) = tag_def.print_conv {
            match print_conv {
                PrintConv::None => value.clone(),
                PrintConv::Function(func) => func(value, None),
                PrintConv::Simple(lookup) => {
                    // Look up value in the hash map
                    // ExifTool uses the stringified value as the key
                    let key = value.to_string();
                    if let Some(display_value) = lookup.get(&key) {
                        crate::types::TagValue::String(display_value.to_string())
                    } else {
                        // Key not found - return original value
                        value.clone()
                    }
                }
                PrintConv::Expression(_expr) => {
                    // Runtime expression evaluation removed - all Perl interpretation happens via PPI at build time
                    value.clone() // Fallback to original value when expression not handled by PPI
                }
                _ => value.clone(),
            }
        } else {
            value.clone()
        }
    } else {
        value.clone()
    }
}
